---
title: "Pass Through GFW with V2ray"
date: 2019-06-10T10:06:55+08:00
tags: ['DOCKER']
comments: true
---

`docker-compose.yml`

```yml
version: '3'

services:
  v2ray:
    image: v2ray/official
    volumes:
    - ./config.json:/etc/v2ray/config.json
    expose:
    - "44222" # if you need to change this you should change Caddyfile as well

  caddy:
    image: abiosoft/caddy
    volumes:
    - ./Caddyfile:/etc/Caddyfile:ro
    - ./caddyCertificates:/root/.caddy
    environment:
    - ACME_AGREE=true
    ports:
    - "80:80"
    - "443:443"
```

`config.json`

```json
{
  "log": {
    "access": "/var/log/v2ray/access.log",
    "error": "/var/log/v2ray/error.log",
    "loglevel": "warning"
  },
  "inbounds": [
    {
      "listen": "0.0.0.0",
      "streamSettings": {
        "network": "ws",
        "wsSettings": {
          "path": "/last"
        },
        "security": "none"
      },
      "settings": {
        "clients": [
          {
            "id": "ef50ae52-3f24-4391-a67a-92cf5422f9ff",
            "alterId": 32
          }
        ]
      },
      "protocol": "vmess",
      "port": 44222
    }
  ],
  "outbounds": [
    {
      "tag": "direct",
      "settings": {},
      "protocol": "freedom"
    }
  ]
}
```

`Caddyfile`

```shell
us.ferstar.org {
  log ./caddy.log
  gzip
  tls fer_star@qq.com
# generated by uuid tools for WebSocket path
  proxy /last v2ray:44222 {
    websocket
    header_upstream -Origin
  }
    proxy / https://www.bing.com {
    transparent
  }
}
```
